# PrizmaDeskTask

## Extraction
This ETL process extracts CSV files with transactions and postions data from SFTP Server. 

## Transfromation
Day_id is added to data from each file name and timestamp in each row. 

## Load
Loads transformed data in PostgreeSQL database in two tables fct_transactions and fct_positions.

## Result

### Table fct_positions

day_id  |pos_id      |pos_name                         |current_price|quantity|currency|value   |instrument_type|fx_eur |value_eur  |inserted               |
--------+------------+---------------------------------+-------------+--------+--------+--------+---------------+-------+-----------+-----------------------+
20230102|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.93432|1193.790007|2023-01-24 19:22:50.074|
20230102|stx.442397  |Big Bad Company                  |        22.12|   200.0|EUR     |  4424.0|equity         |    1.0|     4424.0|2023-01-24 19:22:50.074|
20230102|1180        |EUR Account                      |          1.0|   61.94|EUR     |   61.94|cash           |    1.0|      61.94|2023-01-24 19:22:50.074|
20230102|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.963|  5000.0|USD     |  4815.0|bonds          |0.93432|  4498.7508|2023-01-24 19:22:50.074|
20230102|stx.764414  |Funny Company                    |         1.28|   100.0|CHF     |   128.0|equity         | 1.0113|   129.4464|2023-01-24 19:22:50.074|
20230102|927         |CHF Account                      |          1.0|     0.0|CHF     |     0.0|cash           | 1.0113|        0.0|2023-01-24 19:22:50.074|
20230103|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           | 0.9482|1211.524622|2023-01-24 19:22:50.108|
20230103|stx.442397  |Big Bad Company                  |        23.42|   100.0|EUR     |  2342.0|equity         |    1.0|     2342.0|2023-01-24 19:22:50.108|
20230103|1180        |EUR Account                      |          1.0| 2361.94|EUR     | 2361.94|cash           |    1.0|    2361.94|2023-01-24 19:22:50.108|
20230103|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.968|  5000.0|USD     |  4840.0|bonds          | 0.9482|   4589.288|2023-01-24 19:22:50.108|
20230103|stx.764414  |Funny Company                    |         1.12|   100.0|CHF     |   112.0|equity         | 1.0129|   113.4448|2023-01-24 19:22:50.108|
20230103|927         |CHF Account                      |          1.0|     0.0|CHF     |     0.0|cash           | 1.0129|        0.0|2023-01-24 19:22:50.108|
20230104|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.94261|1204.382223|2023-01-24 19:22:50.138|
20230104|stx.442397  |Big Bad Company                  |        23.19|   100.0|EUR     |  2319.0|equity         |    1.0|     2319.0|2023-01-24 19:22:50.138|
20230104|1180        |EUR Account                      |          1.0| 2361.94|EUR     | 2361.94|cash           |    1.0|    2361.94|2023-01-24 19:22:50.138|
20230104|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.967|  5000.0|USD     |  4835.0|bonds          |0.94261| 4557.51935|2023-01-24 19:22:50.138|
20230104|stx.764414  |Funny Company                    |         1.12|   100.0|CHF     |   112.0|equity         | 1.0141|   113.5792|2023-01-24 19:22:50.138|
20230104|927         |CHF Account                      |          1.0|     0.0|CHF     |     0.0|cash           | 1.0141|        0.0|2023-01-24 19:22:50.138|
20230105|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.95038| 1214.31003|2023-01-24 19:22:50.167|
20230105|stx.442397  |Big Bad Company                  |        23.23|   100.0|EUR     |  2323.0|equity         |    1.0|     2323.0|2023-01-24 19:22:50.167|
20230105|1180        |EUR Account                      |          1.0| 2361.94|EUR     | 2361.94|cash           |    1.0|    2361.94|2023-01-24 19:22:50.167|
20230105|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.966|  5000.0|USD     |  4830.0|bonds          |0.95038|  4590.3354|2023-01-24 19:22:50.167|
20230105|stx.764414  |Funny Company                    |         1.14|   100.0|CHF     |   114.0|equity         | 1.0152|   115.7328|2023-01-24 19:22:50.167|
20230105|927         |CHF Account                      |          1.0|  5397.5|CHF     |  5397.5|cash           | 1.0152|   5479.542|2023-01-24 19:22:50.167|
20230105|stx.164008  |Chocolate Factory                |        19.62|   250.0|CHF     |  4905.0|equity         | 1.0152|   4979.556|2023-01-24 19:22:50.167|
20230106|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.93773|1198.146998|2023-01-24 19:22:50.199|
20230106|stx.442397  |Big Bad Company                  |        23.22|   100.0|EUR     |  2322.0|equity         |    1.0|     2322.0|2023-01-24 19:22:50.199|
20230106|1180        |EUR Account                      |          1.0| 2361.94|EUR     | 2361.94|cash           |    1.0|    2361.94|2023-01-24 19:22:50.199|
20230106|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.969|  5000.0|USD     |  4845.0|bonds          |0.93773| 4543.30185|2023-01-24 19:22:50.199|
20230106|stx.764414  |Funny Company                    |         1.18|   100.0|CHF     |   118.0|equity         | 1.0103|   119.2154|2023-01-24 19:22:50.199|
20230106|927         |CHF Account                      |          1.0|  5397.5|CHF     |  5397.5|cash           | 1.0103| 5453.09425|2023-01-24 19:22:50.199|
20230106|stx.164008  |Chocolate Factory                |         20.6|   250.0|CHF     |  5150.0|equity         | 1.0103|   5203.045|2023-01-24 19:22:50.199|
20230109|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.93157|1190.276305|2023-01-24 19:22:50.230|
20230109|stx.442397  |Big Bad Company                  |        23.21|   100.0|EUR     |  2321.0|equity         |    1.0|     2321.0|2023-01-24 19:22:50.230|
20230109|1180        |EUR Account                      |          1.0| 2361.94|EUR     | 2361.94|cash           |    1.0|    2361.94|2023-01-24 19:22:50.230|
20230109|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.971|  5000.0|USD     |  4855.0|bonds          |0.93157| 4522.77235|2023-01-24 19:22:50.230|
20230109|stx.764414  |Funny Company                    |         1.05|   100.0|CHF     |   105.0|equity         | 1.0115|   106.2075|2023-01-24 19:22:50.230|
20230109|927         |CHF Account                      |          1.0|  5397.5|CHF     |  5397.5|cash           | 1.0115| 5459.57125|2023-01-24 19:22:50.230|
20230109|stx.164008  |Chocolate Factory                |        22.39|   250.0|CHF     |  5597.5|equity         | 1.0115| 5661.87125|2023-01-24 19:22:50.230|
20230110|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.93122|1189.829106|2023-01-24 19:22:50.261|
20230110|stx.442397  |Big Bad Company                  |        22.65|   100.0|EUR     |  2265.0|equity         |    1.0|     2265.0|2023-01-24 19:22:50.261|
20230110|1180        |EUR Account                      |          1.0| 737.294|EUR     | 737.294|cash           |    1.0|    737.294|2023-01-24 19:22:50.261|
20230110|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.978|  5000.0|USD     |  4890.0|bonds          |0.93122|  4553.6658|2023-01-24 19:22:50.261|
20230110|stx.764414  |Funny Company                    |         1.07|   100.0|CHF     |   107.0|equity         | 1.0095|   108.0165|2023-01-24 19:22:50.261|
20230110|927         |CHF Account                      |          1.0|  5397.5|CHF     |  5397.5|cash           | 1.0095| 5448.77625|2023-01-24 19:22:50.261|
20230110|stx.164008  |Chocolate Factory                |        22.14|   250.0|CHF     |  5535.0|equity         | 1.0095|  5587.5825|2023-01-24 19:22:50.261|
20230110|crpt.BTCXEUR|Bitcoin                          |     16391.62|     0.1|EUR     |1639.162|crypto         |    1.0|   1639.162|2023-01-24 19:22:50.261|
20230111|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.93209|1190.940714|2023-01-24 19:22:50.292|
20230111|stx.442397  |Big Bad Company                  |        22.55|   100.0|EUR     |  2255.0|equity         |    1.0|     2255.0|2023-01-24 19:22:50.292|
20230111|1180        |EUR Account                      |          1.0| 737.294|EUR     | 737.294|cash           |    1.0|    737.294|2023-01-24 19:22:50.292|
20230111|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.976|  5000.0|USD     |  4880.0|bonds          |0.93209|  4548.5992|2023-01-24 19:22:50.292|
20230111|stx.764414  |Funny Company                    |         1.11|   100.0|CHF     |   111.0|equity         | 1.0094|   112.0434|2023-01-24 19:22:50.292|
20230111|927         |CHF Account                      |          1.0| 11120.0|CHF     | 11120.0|cash           | 1.0094|  11224.528|2023-01-24 19:22:50.292|
20230111|stx.164008  |Chocolate Factory                |        22.89|     0.0|CHF     |     0.0|equity         | 1.0094|        0.0|2023-01-24 19:22:50.292|
20230111|crpt.BTCXEUR|Bitcoin                          |     17642.78|     0.1|EUR     |1764.278|crypto         |    1.0|   1764.278|2023-01-24 19:22:50.292|
20230112|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.92085|1176.579254|2023-01-24 19:22:50.329|
20230112|stx.442397  |Big Bad Company                  |        22.56|   100.0|EUR     |  2256.0|equity         |    1.0|     2256.0|2023-01-24 19:22:50.329|
20230112|1180        |EUR Account                      |          1.0| 737.294|EUR     | 737.294|cash           |    1.0|    737.294|2023-01-24 19:22:50.329|
20230112|bnd.US9307  |United States Bond 2027 Mar 3.71%|         0.97|  5000.0|USD     |  4850.0|bonds          |0.92085|  4466.1225|2023-01-24 19:22:50.329|
20230112|stx.764414  |Funny Company                    |         1.15|   100.0|CHF     |   115.0|equity         |0.99312|   114.2088|2023-01-24 19:22:50.329|
20230112|927         |CHF Account                      |          1.0| 11120.0|CHF     | 11120.0|cash           |0.99312| 11043.4944|2023-01-24 19:22:50.329|
20230112|crpt.BTCXEUR|Bitcoin                          |     18349.25|     0.1|EUR     |1834.925|crypto         |    1.0|   1834.925|2023-01-24 19:22:50.329|
20230113|1234        |USD Account                      |          1.0| 1277.71|USD     | 1277.71|cash           |0.92193| 1177.95918|2023-01-24 19:22:50.360|
20230113|stx.442397  |Big Bad Company                  |        22.61|   100.0|EUR     |  2261.0|equity         |    1.0|     2261.0|2023-01-24 19:22:50.360|
20230113|1180        |EUR Account                      |          1.0| 737.294|EUR     | 737.294|cash           |    1.0|    737.294|2023-01-24 19:22:50.360|
20230113|bnd.US9307  |United States Bond 2027 Mar 3.71%|        0.971|  5000.0|USD     |  4855.0|bonds          |0.92193| 4475.97015|2023-01-24 19:22:50.360|
20230113|stx.764414  |Funny Company                    |         1.06|   100.0|CHF     |   106.0|equity         |0.99409|  105.37354|2023-01-24 19:22:50.360|
20230113|927         |CHF Account                      |          1.0|  1120.0|CHF     |  1120.0|cash           |0.99409|  1113.3808|2023-01-24 19:22:50.360|
20230113|crpt.BTCXEUR|Bitcoin                          |     18993.73|     0.1|EUR     |1899.373|crypto         |    1.0|   1899.373|2023-01-24 19:22:50.360|

### Table fct transactions

day_id  |trx_id |pos_id      |description                      |trx_type  |quantity|price   |value   |currency|inserted               |
--------+-------+------------+---------------------------------+----------+--------+--------+--------+--------+-----------------------+
20230103|1020452|stx.442397  |Sell 100 Big Bad Company @23.00  |sell      |    -100|      23|   -2300|EUR     |2023-01-24 19:22:50.389|
20230105|1021769|927         |Deposit 10'000.00 CHF            |deposit   |   10000|     1.0| 10000.0|CHF     |2023-01-24 19:22:50.422|
20230105|1021945|stx.164008  |Buy 250 Chocolate Factory @18.41 |buy       |     250|   18.41|  4602.5|CHF     |2023-01-24 19:22:50.422|
20230110|1023187|crpt.BTCXEUR|Buy 0.1 Bitcoin @16'246.46       |buy       |     0.1|16246.46|1624.646|EUR     |2023-01-24 19:22:50.455|
20230111|1023847|stx.164008  |Sell 250 Chocolate Factory @22.89|sell      |    -250|   22.89| -5722.5|CHF     |2023-01-24 19:22:50.484|
20230113|1026123|927         |Withdraw 10'000.00 CHF           |withdrawal|  -10000|       1|  -10000|CHF     |2023-01-24 19:22:50.513|
